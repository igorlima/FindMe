function FingerBlast(a){this.element=typeof a=="string"?document.querySelector(a):a;this.listen()}FingerBlast.prototype={x:NaN,y:NaN,startDistance:NaN,startAngle:NaN,mouseIsDown:false,listen:function(){var b=this.activate.bind(this);var c=this.deactivate.bind(this);function a(f,e){var h,d,g;if("compareDocumentPosition" in e){return !!(e.compareDocumentPosition(f)&16)}else{if("contains" in e){return e!=f&&e.contains(f)}else{for(h=e.getElementsByTagName("*"),d=0;g=h[d++];){if(g==f){return true}}return false}}}this.element.addEventListener("mouseover",function(f){var d=f.relatedTarget;if(d!=this&&!a(d,this)){b()}});this.element.addEventListener("mouseout",function(f){var d=f.relatedTarget;if(d!=this&&!a(d,this)){c(f)}})},activate:function(){if(this.active){return}this.element.addEventListener("mousedown",(this.touchStart=this.touchStart.bind(this)),true);this.element.addEventListener("mousemove",(this.touchMove=this.touchMove.bind(this)),true);this.element.addEventListener("mouseup",(this.touchEnd=this.touchEnd.bind(this)),true);this.element.addEventListener("click",(this.click=this.click.bind(this)),true);this.active=true},deactivate:function(a){this.active=false;if(this.mouseIsDown){this.touchEnd(a)}this.element.removeEventListener("mousedown",this.touchStart,true);this.element.removeEventListener("mousemove",this.touchMove,true);this.element.removeEventListener("mouseup",this.touchEnd,true);this.element.removeEventListener("click",this.click,true)},click:function(a){if(a.synthetic){return}a.preventDefault();a.stopPropagation()},touchStart:function(a){if(a.synthetic||/input|textarea/.test(a.target.tagName.toLowerCase())){return}this.mouseIsDown=true;a.preventDefault();a.stopPropagation();this.fireTouchEvents("touchstart",a)},touchMove:function(a){if(a.synthetic){return}a.preventDefault();a.stopPropagation();this.move(a.clientX,a.clientY);if(this.mouseIsDown){this.fireTouchEvents("touchmove",a)}},touchEnd:function(a){if(a.synthetic){return}this.mouseIsDown=false;a.preventDefault();a.stopPropagation();this.fireTouchEvents("touchend",a);if(!this.target){return}this.target.dispatchEvent(this.createMouseEvent("mouseover",a));this.target.dispatchEvent(this.createMouseEvent("mousemove",a));this.target.dispatchEvent(this.createMouseEvent("mousedown",a))},fireTouchEvents:function(g,b){var l=[];var f=[];if(!this.target){return}var j="on"+g;if(j in this.target){console.warn("Converting `"+j+"` property to event listener.",this.target);this.target.addEventListener(g,this.target[j],false);delete this.target[j]}if(this.target.hasAttribute(j)){console.warn("Converting `"+j+"` attribute to event listener.",this.target);var k=new GLOBAL.Function("event",this.target.getAttribute(j));this.target.addEventListener(g,k,false);this.target.removeAttribute(j)}var d=this.createMouseEvent(g,b);l.push(d);if(l.length>1){var i=l[0].pageX-l[1].pageX;var h=l[0].pageY-l[1].pageY;var a=Math.sqrt(Math.pow(i,2)+Math.pow(h,2));var c=Math.atan2(i,h)*(180/Math.PI);var e="gesturechange";if(g==="touchstart"){e="gesturestart";this.startDistance=a;this.startAngle=c}if(g==="touchend"){e="gestureend"}l.forEach(function(n){var m=this.createMouseEvent.call(n._finger,e,n);f.push(m)}.bind(this));l.concat(f).forEach(function(m){m.scale=a/this.startDistance;m.rotation=this.startAngle-c})}l.forEach(function(m){m.touches=l.filter(function(n){return ~n.type.indexOf("touch")&&n.type!=="touchend"});m.changedTouches=l.filter(function(n){return ~n.type.indexOf("touch")&&n._finger.target===m._finger.target});m.targetTouches=m.changedTouches.filter(function(n){return ~n.type.indexOf("touch")&&n.type!=="touchend"})});l.concat(f).forEach(function(n,m){n.identifier=m;n._finger.target.dispatchEvent(n)})},createMouseEvent:function(b,a){var c=document.createEvent("MouseEvent");c.initMouseEvent(b,true,true,a.view,a.detail,this.x||a.screenX,this.y||a.screenY,this.x||a.clientX,this.y||a.clientY,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey,a.button,this.target||a.relatedTarget);c.synthetic=true;c._finger=this;return c},move:function(a,b){if(isNaN(a)||isNaN(b)){this.target=null}else{this.x=a;this.y=b;if(!this.mouseIsDown){this.target=document.elementFromPoint(a,b)}}}};